<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historias de la Enfermera Panda y el Doctor Mono</title>
    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- FontAwesome -->
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;500;600;700&family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Twemoji -->
    <script src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js"></script>
    <style>
        :root {
            --primary-color: #FF9BE8;
            --secondary-color: #89CFF0;
            --tertiary-color: #FCFF5D;
            --accent-color: #FF6B6B;
            --background-gradient: linear-gradient(45deg, #FFD6FF, #E7C6FF, #B8C0FF, #C8F7FF);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            background: var(--background-gradient);
            background-size: 400% 400%;
            animation: gradient-shift 15s ease infinite;
            min-height: 100vh;
            padding: 2rem 1rem;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Baloo 2', cursive;
        }
        
        /* Animaciones generales */
        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeInLeft {
            from { opacity: 0; transform: translateX(-50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes fadeInRight {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes rainbow-border {
            0% { border-color: #ff0000; }
            14% { border-color: #ff7f00; }
            28% { border-color: #ffff00; }
            42% { border-color: #00ff00; }
            56% { border-color: #0000ff; }
            70% { border-color: #4b0082; }
            84% { border-color: #9400d3; }
            100% { border-color: #ff0000; }
        }
        
        /* Estilos específicos de la aplicación */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .app-title {
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            color: #512B81;
            margin-bottom: 1.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            animation: pulse 2s infinite ease-in-out;
        }
        
        .card {
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.2);
            backdrop-filter: blur(4px);
            padding: 2rem;
            margin-bottom: 2rem;
            border: 4px solid transparent;
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(31, 38, 135, 0.3);
        }
        
        .rainbow-border {
            animation: rainbow-border 5s linear infinite;
        }
        
        .character-card {
            text-align: center;
            padding: 1.5rem;
            animation: fadeIn 1s, float 3s infinite ease-in-out;
        }
        
        .character-emoji {
            font-size: 5rem;
            margin-bottom: 1rem;
        }
        
        .character-name {
            font-size: 1.8rem;
            font-weight: 700;
            color: #512B81;
            margin-bottom: 0.5rem;
        }
        
        .character-quote {
            font-style: italic;
            color: #666;
        }
        
        .form-container {
            animation: fadeIn 1s 0.3s both;
        }
        
        .select-group {
            margin-bottom: 1.5rem;
        }
        
        .select-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #512B81;
        }
        
        .custom-select {
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: 10px;
            border: 2px solid #ddd;
            background-color: white;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .custom-select:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .custom-select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(137, 207, 240, 0.3);
        }
        
        .submit-btn {
            background: linear-gradient(45deg, #FF9BE8, #89CFF0);
            color: white;
            font-family: 'Baloo 2', cursive;
            font-size: 1.2rem;
            font-weight: 600;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: block;
            margin: 2rem auto;
            animation: pulse 2s infinite;
        }
        
        .submit-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 7px 20px rgba(0, 0, 0, 0.25);
        }
        
        .story-container {
            display: none;
            animation: fadeIn 1s;
        }
        
        .story-title {
            font-size: 2rem;
            color: #512B81;
            text-align: center;
            margin-bottom: 1.5rem;
            animation: fadeIn 1s;
        }
        
        .story-paragraph {
            margin-bottom: 1.2rem;
            line-height: 1.6;
            font-size: 1.1rem;
            opacity: 0;
        }
        
        .story-emoji {
            font-size: 1.5rem;
            margin: 0 0.2rem;
            vertical-align: middle;
        }
        
        .new-story-btn {
            background: linear-gradient(45deg, #89CFF0, #FCFF5D);
            color: #512B81;
            font-family: 'Baloo 2', cursive;
            font-size: 1.2rem;
            font-weight: 600;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: block;
            margin: 2rem auto;
        }
        
        .new-story-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(0, 0, 0, 0.25);
        }
        
        .footer {
            text-align: center;
            margin-top: 3rem;
            color: #512B81;
            font-size: 0.9rem;
        }
        
        /* Animación para el loading entre la generación de historia */
        .loading {
            display: none;
            text-align: center;
            margin: 2rem 0;
        }
        
        .loading-dots {
            display: inline-block;
        }
        
        .loading-dots span {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #512B81;
            margin: 0 5px;
        }
        
        .loading-dots span:nth-child(1) {
            animation: bounce 1s infinite 0s;
        }
        
        .loading-dots span:nth-child(2) {
            animation: bounce 1s infinite 0.2s;
        }
        
        .loading-dots span:nth-child(3) {
            animation: bounce 1s infinite 0.4s;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        
        /* Responsive tweaks */
        @media (max-width: 768px) {
            .app-title {
                font-size: 2rem;
            }
            
            .character-emoji {
                font-size: 4rem;
            }
            
            .character-name {
                font-size: 1.5rem;
            }
            
            .story-title {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <h1 class="app-title">Historias de la Enfermera Panda y el Doctor Mono</h1>
        
        <!-- Sección de personajes -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="character-card card rainbow-border" style="animation-delay: 0s;">
                <div class="character-emoji">🐼</div>
                <h2 class="character-name">Enfermera Panda</h2>
                <p class="character-quote">"¡Con una sonrisa y un abrazo, cualquier dolor se va volando!"</p>
                <p class="mt-4">La Enfermera Panda es dulce y cariñosa. Siempre sabe cómo hacer sentir mejor a sus pacientes con su paciencia infinita y su bolsa llena de vendas coloridas.</p>
            </div>
            
            <div class="character-card card rainbow-border" style="animation-delay: 0.5s;">
                <div class="character-emoji">🐒</div>
                <h2 class="character-name">Doctor Mono</h2>
                <p class="character-quote">"¡La mejor medicina es reír tres veces al día!"</p>
                <p class="mt-4">El Doctor Mono es juguetón y divertido. Con sus chistes y bromas hace que hasta los tratamientos más aburridos se conviertan en aventuras emocionantes.</p>
            </div>
        </div>
        
        <!-- Formulario de personalización -->
        <div class="form-container card">
            <h2 class="text-xl md:text-2xl font-bold text-center mb-6 text-indigo-900">¡Crea tu propia historia!</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="select-group">
                    <label for="childName" class="select-label">Nombre del niño/a (opcional)</label>
                    <input type="text" id="childName" class="custom-select" placeholder="Deja en blanco para no incluir un nombre">
                </div>
                
                <div class="select-group">
                    <label for="place" class="select-label">Lugar de la historia</label>
                    <select id="place" class="custom-select">
                        <option value="hospital">Hospital 🏥</option>
                        <option value="parque">Parque 🌳</option>
                        <option value="escuela">Escuela 🏫</option>
                        <option value="playa">Playa 🏖️</option>
                        <option value="bosque">Bosque 🌲</option>
                        <option value="zoo">Zoológico 🦁</option>
                        <option value="granja">Granja 🐄</option>
                        <option value="casa">Casa 🏠</option>
                        <option value="montaña">Montaña ⛰️</option>
                        <option value="espacio">Espacio exterior 🚀</option>
                        <option value="circo">Circo 🎪</option>
                        <option value="biblioteca">Biblioteca 📚</option>
                    </select>
                </div>
                
                <div class="select-group">
                    <label for="problem" class="select-label">Problema a resolver</label>
                    <select id="problem" class="custom-select">
                        <option value="resfriado">Resfriado 🤧</option>
                        <option value="miedo">Miedo a la oscuridad 🌙</option>
                        <option value="herida">Herida en la rodilla 🩹</option>
                        <option value="tristeza">Tristeza 😢</option>
                        <option value="pesadilla">Pesadilla 😱</option>
                        <option value="soledad">Soledad 🧸</option>
                        <option value="compartir">No querer compartir 🤲</option>
                        <option value="dientes">Dolor de dientes 🦷</option>
                        <option value="berrinche">Berrinche 😤</option>
                        <option value="comida">No querer comer verduras 🥦</option>
                        <option value="perdido">Estar perdido 🗺️</option>
                        <option value="amistad">Hacer nuevos amigos 👋</option>
                    </select>
                </div>
                
                <div class="select-group">
                    <label for="friend" class="select-label">Amigo que aparece</label>
                    <select id="friend" class="custom-select">
                        <option value="leon">León 🦁</option>
                        <option value="jirafa">Jirafa 🦒</option>
                        <option value="elefante">Elefante 🐘</option>
                        <option value="tigre">Tigre 🐯</option>
                        <option value="conejo">Conejo 🐰</option>
                        <option value="tortuga">Tortuga 🐢</option>
                        <option value="mariposa">Mariposa 🦋</option>
                        <option value="delfin">Delfín 🐬</option>
                        <option value="buho">Búho 🦉</option>
                        <option value="perro">Perro 🐶</option>
                        <option value="gato">Gato 🐱</option>
                        <option value="dragon">Dragón 🐲</option>
                    </select>
                </div>
                
                <div class="select-group">
                    <label for="weather" class="select-label">Clima de la historia</label>
                    <select id="weather" class="custom-select">
                        <option value="soleado">Soleado ☀️</option>
                        <option value="lluvia">Lluvioso 🌧️</option>
                        <option value="nieve">Nevado ❄️</option>
                        <option value="tormenta">Tormenta eléctrica ⚡</option>
                        <option value="arcoiris">Arcoíris 🌈</option>
                        <option value="niebla">Niebla 🌫️</option>
                        <option value="viento">Ventoso 🌪️</option>
                        <option value="calor">Mucho calor 🔥</option>
                        <option value="estrellado">Noche estrellada ✨</option>
                        <option value="nublado">Nublado ☁️</option>
                    </select>
                </div>
                
                <div class="select-group">
                    <label for="magicObject" class="select-label">Objeto mágico</label>
                    <select id="magicObject" class="custom-select">
                        <option value="varita">Varita mágica ✨</option>
                        <option value="pocion">Poción burbujeante 🧪</option>
                        <option value="mapa">Mapa del tesoro 🗺️</option>
                        <option value="espejo">Espejo encantado 🪞</option>
                        <option value="lampara">Lámpara maravillosa 🪔</option>
                        <option value="libro">Libro de hechizos 📕</option>
                        <option value="llave">Llave dorada 🔑</option>
                        <option value="reloj">Reloj que detiene el tiempo ⏰</option>
                        <option value="semilla">Semilla que crece instantáneamente 🌱</option>
                        <option value="baston">Bastón de nubes ☁️</option>
                        <option value="alfombra">Alfombra voladora 🧞</option>
                        <option value="caramelo">Caramelo de superpoders 🍬</option>
                    </select>
                </div>
                
                <div class="select-group">
                    <label for="ending" class="select-label">Final de la historia</label>
                    <select id="ending" class="custom-select">
                        <option value="fiesta">Fiesta de celebración 🎉</option>
                        <option value="aprendizaje">Lección aprendida 📝</option>
                        <option value="amistad">Nueva amistad 🤝</option>
                        <option value="aventura">Nueva aventura 🧭</option>
                        <option value="regalo">Regalo sorpresa 🎁</option>
                        <option value="cancion">Canción alegre 🎵</option>
                        <option value="abrazo">Abrazo grupal 🫂</option>
                        <option value="estrella">Deseo a una estrella ⭐</option>
                        <option value="arcoiris">Arcoíris mágico 🌈</option>
                        <option value="dormir">Dulces sueños 💤</option>
                    </select>
                </div>
            </div>
            
            <button id="generateBtn" class="submit-btn">¡Generar Historia Mágica!</button>
        </div>
        
        <!-- Loading indicator -->
        <div class="loading" id="loadingIndicator">
            <p class="font-bold text-indigo-900 mb-3">Creando una historia maravillosa...</p>
            <div class="loading-dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <!-- Contenedor de la historia -->
        <div class="story-container card" id="storyContainer">
            <h2 class="story-title" id="storyTitle">Título de la Historia</h2>
            <div id="storyContent"></div>
            <button id="newStoryBtn" class="new-story-btn">¡Crear otra historia!</button>
        </div>
        
        <footer class="footer">
            <p>© 2025, Historias de la Enfermera Panda y el Doctor Mono | Todos los derechos reservados DR GÓMEZ</p>
        </footer>
    </div>
    
    <script>
        // Inicializar Twemoji
        window.onload = function() {
            twemoji.parse(document.body, {
                folder: 'svg',
                ext: '.svg'
            });
        };
        
        // Variables y elementos
        const generateBtn = document.getElementById('generateBtn');
        const newStoryBtn = document.getElementById('newStoryBtn');
        const formContainer = document.querySelector('.form-container');
        const storyContainer = document.getElementById('storyContainer');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const storyTitle = document.getElementById('storyTitle');
        const storyContent = document.getElementById('storyContent');
        
        // Títulos aleatorios para las historias
        const storyTitles = [
            "La Gran Aventura de Curación",
            "Un Día Especial con Panda y Mono",
            "La Misión de Ayuda Mágica",
            "El Problema Especial",
            "El Rescate Increíble",
            "Una Lección para Recordar",
            "La Sorpresa del Doctor Mono",
            "El Plan Secreto de la Enfermera Panda",
            "Un Momento de Valentía",
            "El Misterio del Día Extraño",
            "La Solución Inesperada",
            "Aventuras de Amistad y Coraje",
            "El Día que Todo Cambió",
            "La Magia de Ayudar a los Demás"
        ];
        
        // Emojis asociados a cada opción
        const emojiMap = {
            places: {
                hospital: "🏥",
                parque: "🌳",
                escuela: "🏫",
                playa: "🏖️",
                bosque: "🌲",
                zoo: "🦁",
                granja: "🐄",
                casa: "🏠",
                montaña: "⛰️",
                espacio: "🚀",
                circo: "🎪",
                biblioteca: "📚"
            },
            problems: {
                resfriado: "🤧",
                miedo: "🌙",
                herida: "🩹",
                tristeza: "😢",
                pesadilla: "😱",
                soledad: "🧸",
                compartir: "🤲",
                dientes: "🦷",
                berrinche: "😤",
                comida: "🥦",
                perdido: "🗺️",
                amistad: "👋"
            },
            friends: {
                leon: "🦁",
                jirafa: "🦒",
                elefante: "🐘",
                tigre: "🐯",
                conejo: "🐰",
                tortuga: "🐢",
                mariposa: "🦋",
                delfin: "🐬",
                buho: "🦉",
                perro: "🐶",
                gato: "🐱",
                dragon: "🐲"
            },
            weather: {
                soleado: "☀️",
                lluvia: "🌧️",
                nieve: "❄️",
                tormenta: "⚡",
                arcoiris: "🌈",
                niebla: "🌫️",
                viento: "🌪️",
                calor: "🔥",
                estrellado: "✨",
                nublado: "☁️"
            },
            magicObjects: {
                varita: "✨",
                pocion: "🧪",
                mapa: "🗺️",
                espejo: "🪞",
                lampara: "🪔",
                libro: "📕",
                llave: "🔑",
                reloj: "⏰",
                semilla: "🌱",
                baston: "☁️",
                alfombra: "🧞",
                caramelo: "🍬"
            },
            endings: {
                fiesta: "🎉",
                aprendizaje: "📝",
                amistad: "🤝",
                aventura: "🧭",
                regalo: "🎁",
                cancion: "🎵",
                abrazo: "🫂",
                estrella: "⭐",
                arcoiris: "🌈",
                dormir: "💤"
            }
        };
        
        // Event Listeners
        generateBtn.addEventListener('click', generateStory);
        newStoryBtn.addEventListener('click', resetStory);
        
        // Funciones para generar historias
        function generateStory() {
            // Mostrar indicador de carga
            formContainer.style.display = 'none';
            loadingIndicator.style.display = 'block';
            
            // Obtener valores seleccionados
            const childName = document.getElementById('childName').value.trim();
            const place = document.getElementById('place').value;
            const problem = document.getElementById('problem').value;
            const friend = document.getElementById('friend').value;
            const weather = document.getElementById('weather').value;
            const magicObject = document.getElementById('magicObject').value;
            const ending = document.getElementById('ending').value;
            
            // Nombres legibles para los valores seleccionados
            const placeNames = {
                hospital: "el hospital", parque: "el parque", escuela: "la escuela", playa: "la playa",
                bosque: "el bosque", zoo: "el zoológico", granja: "la granja", casa: "la casa",
                montaña: "la montaña", espacio: "el espacio exterior", circo: "el circo", biblioteca: "la biblioteca"
            };
            
            const problemNames = {
                resfriado: "un fuerte resfriado", miedo: "miedo a la oscuridad", herida: "una herida en la rodilla",
                tristeza: "una gran tristeza", pesadilla: "terribles pesadillas", soledad: "sentirse solo",
                compartir: "no querer compartir juguetes", dientes: "un dolor de dientes",
                berrinche: "un gran berrinche", comida: "no querer comer verduras",
                perdido: "haberse perdido", amistad: "dificultad para hacer amigos"
            };
            
            const friendNames = {
                leon: "León Leo", jirafa: "Jirafa Juana", elefante: "Elefante Eli", tigre: "Tigre Tomás",
                conejo: "Conejo Carlos", tortuga: "Tortuga Tina", mariposa: "Mariposa Mia", delfin: "Delfín Dani",
                buho: "Búho Bruno", perro: "Perro Paco", gato: "Gata Gala", dragon: "Dragón Dante"
            };
            
            const weatherDescriptions = {
                soleado: "un día soleado y brillante", lluvia: "un día lluvioso con gotas de agua bailando",
                nieve: "un hermoso día nevado con copos blancos cayendo", tormenta: "un día de tormenta con relámpagos asombrosos",
                arcoiris: "un día con un arcoíris gigante en el cielo", niebla: "un día con niebla misteriosa",
                viento: "un día ventoso con hojas danzando", calor: "un día muy caluroso",
                estrellado: "una noche estrellada con estrellas brillantes", nublado: "un día nublado con nubes esponjosas"
            };
            
            const magicObjectNames = {
                varita: "una varita mágica brillante", pocion: "una poción burbujeante de colores",
                mapa: "un mapa del tesoro antiguo", espejo: "un espejo encantado parlante",
                lampara: "una lámpara maravillosa dorada", libro: "un libro de hechizos con páginas luminosas",
                llave: "una llave dorada que abre cualquier puerta", reloj: "un reloj que puede detener el tiempo",
                semilla: "una semilla mágica que crece en segundos", baston: "un bastón que crea nubes suaves",
                alfombra: "una pequeña alfombra voladora", caramelo: "un caramelo que da superpoderes temporales"
            };
            
            const endingDescriptions = {
                fiesta: "una gran fiesta de celebración con música y baile",
                aprendizaje: "aprendiendo una valiosa lección sobre la vida",
                amistad: "el inicio de una hermosa amistad que duraría para siempre",
                aventura: "el comienzo de una nueva aventura aún más emocionante",
                regalo: "un regalo sorpresa especial que nadie esperaba",
                cancion: "todos cantando una canción alegre y divertida",
                abrazo: "un cálido abrazo grupal lleno de cariño",
                estrella: "pedir un deseo especial a la primera estrella de la noche",
                arcoiris: "la aparición de un arcoíris mágico que cumplía deseos",
                dormir: "todos durmiendo con dulces sueños y sonrisas"
            };
            
            // Construir la historia
            const placeText = placeNames[place];
            const problemText = problemNames[problem];
            const friendText = friendNames[friend];
            const weatherText = weatherDescriptions[weather];
            const magicObjectText = magicObjectNames[magicObject];
            const endingText = endingDescriptions[ending];
            
            const placeEmoji = emojiMap.places[place];
            const problemEmoji = emojiMap.problems[problem];
            const friendEmoji = emojiMap.friends[friend];
            const weatherEmoji = emojiMap.weather[weather];
            const magicObjectEmoji = emojiMap.magicObjects[magicObject];
            const endingEmoji = emojiMap.endings[ending];
            
            // Seleccionar un título aleatorio
            const randomTitle = storyTitles[Math.floor(Math.random() * storyTitles.length)];
            storyTitle.textContent = randomTitle;
            
            // Crear la historia
            let story = '';
            
            // Introducción
            let intro = `<p class="story-paragraph">Era ${weatherText} ${weatherEmoji} en ${placeText} ${placeEmoji}. La Enfermera Panda 🐼 y el Doctor Mono 🐒 estaban listos para ayudar a quien lo necesitara.`;
            
            if (childName) {
                intro += ` Un niño llamado ${childName} había llegado con ${problemText} ${problemEmoji} y necesitaba ayuda especial.`;
            } else {
                intro += ` Alguien llegó con ${problemText} ${problemEmoji} y necesitaba ayuda especial.`;
            }
            
            intro += `</p>`;
            story += intro;
            
            // Desarrollo
            let development = `
            <p class="story-paragraph">"¡No te preocupes!" dijo la Enfermera Panda con una sonrisa reconfortante. "El Doctor Mono y yo sabemos exactamente qué hacer para ayudarte."</p>
            
            <p class="story-paragraph">Mientras pensaban en una solución, apareció ${friendText} ${friendEmoji} quien traía consigo ${magicObjectText} ${magicObjectEmoji}. "¡Quizás esto pueda ayudar!" exclamó con entusiasmo.</p>
            
            <p class="story-paragraph">El Doctor Mono dio un salto de alegría. "¡Qué buena idea! Con esto podremos resolver el problema de una forma divertida y especial."</p>
            `;
            
            // Personalizar según el problema
            let problemSpecific = '';
            switch(problem) {
                case 'resfriado':
                    problemSpecific = `<p class="story-paragraph">La Enfermera Panda preparó una manta calientita, mientras el Doctor Mono usó ${magicObjectText} para crear una medicina con sabor a frutas tropicales. Los estornudos comenzaron a desaparecer como por arte de magia.</p>`;
                    break;
                case 'miedo':
                    problemSpecific = `<p class="story-paragraph">El Doctor Mono utilizó ${magicObjectText} para iluminar las sombras con luces de colores. "¡Mira! Las sombras solo quieren jugar contigo", explicó con una sonrisa tranquilizadora.</p>`;
                    break;
                case 'herida':
                    problemSpecific = `<p class="story-paragraph">La Enfermera Panda limpió la herida con agua tibia mientras cantaba una canción alegre. Luego, el Doctor Mono pasó ${magicObjectText} por encima, haciendo que apareciera una venda de colores brillantes que contaba chistes.</p>`;
                    break;
                case 'tristeza':
                    problemSpecific = `<p class="story-paragraph">"Las lágrimas son como pequeñas lluvias que limpian el corazón", dijo la Enfermera Panda mientras abrazaba con cariño. El Doctor Mono utilizó ${magicObjectText} para crear burbujas de recuerdos felices que flotaban alrededor.</p>`;
                    break;
                default:
                    problemSpecific = `<p class="story-paragraph">La Enfermera Panda y el Doctor Mono trabajaron juntos, usando ${magicObjectText} de manera creativa. Con cada minuto que pasaba, el problema se iba haciendo más pequeño hasta casi desaparecer.</p>`;
            }
            
            story += development + problemSpecific;
            
            // Conclusión
            let conclusion = `
            <p class="story-paragraph">${friendText} aplaudía emocionado mientras veía cómo todo mejoraba. "¡Sabía que ustedes podrían solucionarlo! Son los mejores ayudantes del mundo."</p>
            
            <p class="story-paragraph">Pronto, el problema estaba completamente resuelto. Para celebrar, todos decidieron terminar el día con ${endingText} ${endingEmoji}.</p>
            
            <p class="story-paragraph">"Recuerda", dijo la Enfermera Panda con dulzura, "cuando tengas un problema, siempre puedes pedir ayuda. Estaremos aquí para ti."</p>
            
            <p class="story-paragraph">"¡Y haremos que sea divertido resolverlo!" añadió el Doctor Mono dando una voltereta en el aire.</p>
            
            <p class="story-paragraph">Y así, con sonrisas en sus rostros y corazones llenos de alegría, terminó otra maravillosa aventura de la Enfermera Panda y el Doctor Mono. ¿Qué nueva misión les esperará mañana? 🐼❤️🐒</p>
            `;
            
            story += conclusion;
            
            // Simular tiempo de carga
            setTimeout(() => {
                loadingIndicator.style.display = 'none';
                storyContainer.style.display = 'block';
                storyContent.innerHTML = story;
                
                // Animar los párrafos secuencialmente
                const paragraphs = document.querySelectorAll('.story-paragraph');
                paragraphs.forEach((paragraph, index) => {
                    setTimeout(() => {
                        paragraph.style.animation = 'fadeIn 1s forwards';
                    }, index * 800);
                });
                
                // Aplicar Twemoji a la historia
                twemoji.parse(storyContent, {
                    folder: 'svg',
                    ext: '.svg'
                });
            }, 2000);
        }
        
        function resetStory() {
            storyContainer.style.display = 'none';
            formContainer.style.display = 'block';
            
            // Resetear los campos del formulario si es necesario
            document.getElementById('childName').value = '';
            
            // Scroll suave hasta el formulario
            formContainer.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
