<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historias de la Enfermera Panda y el Doctor Mono</title>
    <!-- Tailwind CSS desde jsDelivr -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- FontAwesome desde jsDelivr -->
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;500;600;700&family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Twemoji -->
    <script src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js"></script>
    <style>
        :root {
            --primary-color: #FF9BE8;
            --secondary-color: #89CFF0;
            --tertiary-color: #FCFF5D;
            --accent-color: #FF6B6B;
            --background-gradient: linear-gradient(45deg, #FFD6FF, #E7C6FF, #B8C0FF, #C8F7FF);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            background: var(--background-gradient);
            background-size: 400% 400%;
            animation: gradient-shift 15s ease infinite;
            min-height: 100vh;
            padding: 2rem 1rem;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Baloo 2', cursive;
        }
        
        /* Animaciones generales */
        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        @keyframes spin-slow {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes shine {
            0% { box-shadow: 0 0 5px rgba(255, 255, 255, 0.3); }
            50% { box-shadow: 0 0 20px rgba(255, 255, 255, 0.7); }
            100% { box-shadow: 0 0 5px rgba(255, 255, 255, 0.3); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeInLeft {
            from { opacity: 0; transform: translateX(-50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes fadeInRight {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes rainbow-border {
            0% { border-color: #ff0000; }
            14% { border-color: #ff7f00; }
            28% { border-color: #ffff00; }
            42% { border-color: #00ff00; }
            56% { border-color: #0000ff; }
            70% { border-color: #4b0082; }
            84% { border-color: #9400d3; }
            100% { border-color: #ff0000; }
        }
        
        /* Estilos especÃ­ficos de la aplicaciÃ³n */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .app-title {
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            color: #512B81;
            margin-bottom: 1.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            animation: pulse 2s infinite ease-in-out;
        }
        
        .card {
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.2);
            backdrop-filter: blur(4px);
            padding: 2rem;
            margin-bottom: 2rem;
            border: 4px solid transparent;
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(31, 38, 135, 0.3);
        }
        
        .rainbow-border {
            animation: rainbow-border 5s linear infinite;
        }
        
        .character-card {
            text-align: center;
            padding: 1.5rem;
            animation: fadeIn 0.5s, float 3s infinite ease-in-out;
        }
        
        .character-card:hover .character-emoji {
            animation: bounce 1s infinite ease-in-out;
        }
        
        .character-emoji {
            font-size: 5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            display: inline-block;
        }
        
        .character-emoji:hover {
            transform: scale(1.2);
        }
        
        .character-name {
            font-size: 1.8rem;
            font-weight: 700;
            color: #512B81;
            margin-bottom: 0.5rem;
        }
        
        .character-quote {
            font-style: italic;
            color: #666;
        }
        
        .form-container {
            animation: fadeIn 1s 0.3s both;
        }
        
        .select-group {
            margin-bottom: 1.5rem;
        }
        
        .select-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #512B81;
        }
        
        .custom-select {
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: 10px;
            border: 2px solid #ddd;
            background-color: white;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .custom-select:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .custom-select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(137, 207, 240, 0.3);
        }
        
        .submit-btn {
            background: linear-gradient(45deg, #FF9BE8, #89CFF0);
            color: white;
            font-family: 'Baloo 2', cursive;
            font-size: 1.2rem;
            font-weight: 600;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: block;
            margin: 2rem auto 1rem auto;
            animation: pulse 2s infinite;
        }
        
        .random-btn {
            background: linear-gradient(45deg, #FCFF5D, #FF6B6B);
            color: #512B81;
            font-family: 'Baloo 2', cursive;
            font-size: 1.2rem;
            font-weight: 600;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: block;
            margin: 0 auto 2rem auto;
        }
        
        .submit-btn:hover, .random-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 7px 20px rgba(0, 0, 0, 0.25);
            animation: shine 1.5s infinite;
        }
        
        .story-container {
            display: none;
            animation: fadeInUp 1s;
        }
        
        .story-title {
            font-size: 2rem;
            color: #512B81;
            text-align: center;
            margin-bottom: 1.5rem;
            animation: fadeIn 1s;
        }
        
        .story-paragraph {
            margin-bottom: 1.2rem;
            line-height: 1.6;
            font-size: 1.1rem;
            opacity: 0;
            animation: fadeInUp 0.5s forwards;
        }
        
        .story-emoji {
            font-size: 1.5rem;
            margin: 0 0.2rem;
            vertical-align: middle;
            display: inline-block;
        }
        
        .new-story-btn {
            background: linear-gradient(45deg, #89CFF0, #FCFF5D);
            color: #512B81;
            font-family: 'Baloo 2', cursive;
            font-size: 1.2rem;
            font-weight: 600;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: block;
            margin: 2rem auto;
        }
        
        .new-story-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(0, 0, 0, 0.25);
        }
        
        .footer {
            text-align: center;
            margin-top: 3rem;
            color: #512B81;
            font-size: 0.9rem;
            animation: fadeIn 1s 1s both;
        }
        
        /* AnimaciÃ³n para el loading entre la generaciÃ³n de historia */
        .loading {
            display: none;
            text-align: center;
            margin: 2rem 0;
        }
        
        .loading-dots {
            display: inline-block;
        }
        
        .loading-dots span {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #512B81;
            margin: 0 5px;
        }
        
        .loading-dots span:nth-child(1) {
            animation: bounce 1s infinite 0s;
        }
        
        .loading-dots span:nth-child(2) {
            animation: bounce 1s infinite 0.2s;
        }
        
        .loading-dots span:nth-child(3) {
            animation: bounce 1s infinite 0.4s;
        }
        
        .character-floater {
            position: fixed;
            font-size: 3rem;
            z-index: 100;
            animation: float 3s infinite ease-in-out;
        }
        
        .panda-floater {
            bottom: 20px;
            right: 20px;
        }
        
        .monkey-floater {
            top: 20px;
            left: 20px;
        }
        
        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }
        
        .character-bounce {
            animation: bounce 2s infinite;
        }
        
        /* Responsive tweaks */
        @media (max-width: 768px) {
            .app-title {
                font-size: 2rem;
            }
            
            .character-emoji {
                font-size: 4rem;
            }
            
            .character-name {
                font-size: 1.5rem;
            }
            
            .story-title {
                font-size: 1.8rem;
            }
            
            .character-floater {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <h1 class="app-title">Historias de la Enfermera Panda y el Doctor Mono</h1>
        
        <!-- Flotadores de personajes -->
        <div class="character-floater panda-floater">ğŸ¼</div>
        <div class="character-floater monkey-floater">ğŸ’</div>
        
        <!-- SecciÃ³n de personajes -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="character-card card rainbow-border" style="animation-delay: 0s;">
                <div class="character-emoji">ğŸ¼</div>
                <h2 class="character-name">Enfermera Panda</h2>
                <p class="character-quote">"Â¡Con una sonrisa y un abrazo, cualquier dolor se va volando!"</p>
                <p class="mt-4">La Enfermera Panda es dulce y cariÃ±osa. Siempre sabe cÃ³mo hacer sentir mejor a sus pacientes con su paciencia infinita y su bolsa llena de vendas coloridas.</p>
            </div>
            
            <div class="character-card card rainbow-border" style="animation-delay: 0.2s;">
                <div class="character-emoji">ğŸ’</div>
                <h2 class="character-name">Doctor Mono</h2>
                <p class="character-quote">"Â¡La mejor medicina es reÃ­r tres veces al dÃ­a!"</p>
                <p class="mt-4">El Doctor Mono es juguetÃ³n y divertido. Con sus chistes y bromas hace que hasta los tratamientos mÃ¡s aburridos se conviertan en aventuras emocionantes.</p>
            </div>
        </div>
        
        <!-- Formulario de personalizaciÃ³n -->
        <div class="form-container card">
            <h2 class="text-xl md:text-2xl font-bold text-center mb-6 text-indigo-900">Â¡Crea tu propia historia!</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="select-group">
                    <label for="childName" class="select-label">Nombre del niÃ±o/a (opcional)</label>
                    <input type="text" id="childName" class="custom-select" placeholder="Deja en blanco para no incluir un nombre">
                </div>
                
                <div class="select-group">
                    <label for="place" class="select-label">Lugar de la historia</label>
                    <select id="place" class="custom-select">
                        <option value="hospital">Hospital ğŸ¥</option>
                        <option value="parque">Parque ğŸŒ³</option>
                        <option value="escuela">Escuela ğŸ«</option>
                        <option value="playa">Playa ğŸ–ï¸</option>
                        <option value="bosque">Bosque ğŸŒ²</option>
                        <option value="zoo">ZoolÃ³gico ğŸ¦</option>
                        <option value="granja">Granja ğŸ„</option>
                        <option value="casa">Casa ğŸ </option>
                        <option value="montaÃ±a">MontaÃ±a â›°ï¸</option>
                        <option value="espacio">Espacio exterior ğŸš€</option>
                        <option value="circo">Circo ğŸª</option>
                        <option value="biblioteca">Biblioteca ğŸ“š</option>
                        <option value="acuario">Acuario ğŸ </option>
                        <option value="castillo">Castillo ğŸ°</option>
                        <option value="isla">Isla tropical ğŸï¸</option>
                        <option value="submarino">Submarino ğŸ”</option>
                    </select>
                </div>
                
                <div class="select-group">
                    <label for="problem" class="select-label">Problema a resolver</label>
                    <select id="problem" class="custom-select">
                        <option value="resfriado">Resfriado ğŸ¤§</option>
                        <option value="miedo">Miedo a la oscuridad ğŸŒ™</option>
                        <option value="herida">Herida en la rodilla ğŸ©¹</option>
                        <option value="tristeza">Tristeza ğŸ˜¢</option>
                        <option value="pesadilla">Pesadilla ğŸ˜±</option>
                        <option value="soledad">Soledad ğŸ§¸</option>
                        <option value="compartir">No querer compartir ğŸ¤²</option>
                        <option value="dientes">Dolor de dientes ğŸ¦·</option>
                        <option value="berrinche">Berrinche ğŸ˜¤</option>
                        <option value="comida">No querer comer verduras ğŸ¥¦</option>
                        <option value="perdido">Estar perdido ğŸ—ºï¸</option>
                        <option value="amistad">Hacer nuevos amigos ğŸ‘‹</option>
                        <option value="deporte">Miedo a intentar un nuevo deporte ğŸ€</option>
                        <option value="inyeccion">Miedo a las inyecciones ğŸ’‰</option>
                        <option value="examenes">Nervios por los exÃ¡menes ğŸ“</option>
                        <option value="timidez">Timidez ğŸ™ˆ</option>
                    </select>
                </div>
                
                <div class="select-group">
                    <label for="friend" class="select-label">Amigo que aparece</label>
                    <select id="friend" class="custom-select">
                        <option value="leon">LeÃ³n ğŸ¦</option>
                        <option value="jirafa">Jirafa ğŸ¦’</option>
                        <option value="elefante">Elefante ğŸ˜</option>
                        <option value="tigre">Tigre ğŸ¯</option>
                        <option value="conejo">Conejo ğŸ°</option>
                        <option value="tortuga">Tortuga ğŸ¢</option>
                        <option value="mariposa">Mariposa ğŸ¦‹</option>
                        <option value="delfin">DelfÃ­n ğŸ¬</option>
                        <option value="buho">BÃºho ğŸ¦‰</option>
                        <option value="perro">Perro ğŸ¶</option>
                        <option value="gato">Gato ğŸ±</option>
                        <option value="dragon">DragÃ³n ğŸ²</option>
                        <option value="koala">Koala ğŸ¨</option>
                        <option value="unicornio">Unicornio ğŸ¦„</option>
                        <option value="zorro">Zorro ğŸ¦Š</option>
                        <option value="pulpo">Pulpo ğŸ™</option>
                    </select>
                </div>
                
                <div class="select-group">
                    <label for="weather" class="select-label">Clima de la historia</label>
                    <select id="weather" class="custom-select">
                        <option value="soleado">Soleado â˜€ï¸</option>
                        <option value="lluvia">Lluvioso ğŸŒ§ï¸</option>
                        <option value="nieve">Nevado â„ï¸</option>
                        <option value="tormenta">Tormenta elÃ©ctrica âš¡</option>
                        <option value="arcoiris">ArcoÃ­ris ğŸŒˆ</option>
                        <option value="niebla">Niebla ğŸŒ«ï¸</option>
                        <option value="viento">Ventoso ğŸŒªï¸</option>
                        <option value="calor">Mucho calor ğŸ”¥</option>
                        <option value="estrellado">Noche estrellada âœ¨</option>
                        <option value="nublado">Nublado â˜ï¸</option>
                        <option value="granizo">Granizo ğŸ§Š</option>
                        <option value="aurora">Aurora boreal ğŸŒŒ</option>
                    </select>
                </div>
                
                <div class="select-group">
                    <label for="magicObject" class="select-label">Objeto mÃ¡gico</label>
                    <select id="magicObject" class="custom-select">
                        <option value="varita">Varita mÃ¡gica âœ¨</option>
                        <option value="pocion">PociÃ³n burbujeante ğŸ§ª</option>
                        <option value="mapa">Mapa del tesoro ğŸ—ºï¸</option>
                        <option value="espejo">Espejo encantado ğŸª</option>
                        <option value="lampara">LÃ¡mpara maravillosa ğŸª”</option>
                        <option value="libro">Libro de hechizos ğŸ“•</option>
                        <option value="llave">Llave dorada ğŸ”‘</option>
                        <option value="reloj">Reloj que detiene el tiempo â°</option>
                        <option value="semilla">Semilla que crece instantÃ¡neamente ğŸŒ±</option>
                        <option value="baston">BastÃ³n de nubes â˜ï¸</option>
                        <option value="alfombra">Alfombra voladora ğŸ§</option>
                        <option value="caramelo">Caramelo de superpoderes ğŸ¬</option>
                        <option value="guante">Guante que transforma ğŸ§¤</option>
                        <option value="amuleto">Amuleto de la suerte ğŸ”®</option>
                        <option value="sombrero">Sombrero parlante ğŸ©</option>
                        <option value="anillo">Anillo de invisibilidad ğŸ’</option>
                    </select>
                </div>
                
                <div class="select-group">
                    <label for="ending" class="select-label">Final de la historia</label>
                    <select id="ending" class="custom-select">
                        <option value="fiesta">Fiesta de celebraciÃ³n ğŸ‰</option>
                        <option value="aprendizaje">LecciÃ³n aprendida ğŸ“</option>
                        <option value="amistad">Nueva amistad ğŸ¤</option>
                        <option value="aventura">Nueva aventura ğŸ§­</option>
                        <option value="regalo">Regalo sorpresa ğŸ</option>
                        <option value="cancion">CanciÃ³n alegre ğŸµ</option>
                        <option value="abrazo">Abrazo grupal ğŸ«‚</option>
                        <option value="estrella">Deseo a una estrella â­</option>
                        <option value="arcoiris">ArcoÃ­ris mÃ¡gico ğŸŒˆ</option>
                        <option value="dormir">Dulces sueÃ±os ğŸ’¤</option>
                        <option value="desfile">Desfile de celebraciÃ³n ğŸª</option>
                        <option value="picnic">Picnic mÃ¡gico ğŸ§º</option>
                        <option value="medalla">Medalla de valor ğŸ…</option>
                        <option value="viaje">Viaje en globo ğŸˆ</option>
                    </select>
                </div>
            </div>
            
            <button id="generateBtn" class="submit-btn">Â¡Generar Historia MÃ¡gica!</button>
            <button id="randomBtn" class="random-btn">Â¡Historia Aleatoria!</button>
        </div>
        
        <!-- Loading indicator -->
        <div class="loading" id="loadingIndicator">
            <p class="font-bold text-indigo-900 mb-3">Creando una historia maravillosa con la Enfermera Panda y el Doctor Mono...</p>
            <div class="loading-dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <!-- Contenedor de la historia -->
        <div class="story-container card" id="storyContainer">
            <h2 class="story-title" id="storyTitle">TÃ­tulo de la Historia</h2>
            <div id="storyContent"></div>
            <button id="newStoryBtn" class="new-story-btn">Â¡Crear otra historia!</button>
        </div>
        
        <footer class="footer">
            <p>Â© 2025, Historias de la Enfermera Panda y el Doctor Mono | Todos los derechos reservados DR GÃ“MEZ</p>
        </footer>
    </div>
    
    <script>
        // Inicializar Twemoji despuÃ©s de que el DOM estÃ© completamente cargado
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar Twemoji
            twemoji.parse(document.body, {
                folder: 'svg',
                ext: '.svg'
            });
            
            // Variables y elementos
            const generateBtn = document.getElementById('generateBtn');
            const randomBtn = document.getElementById('randomBtn');
            const newStoryBtn = document.getElementById('newStoryBtn');
            const formContainer = document.querySelector('.form-container');
            const storyContainer = document.getElementById('storyContainer');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const storyTitle = document.getElementById('storyTitle');
            const storyContent = document.getElementById('storyContent');
            
            // Lugares para la historia
            const places = {
                hospital: { name: "Hospital", emoji: "ğŸ¥" },
                parque: { name: "Parque", emoji: "ğŸŒ³" },
                escuela: { name: "Escuela", emoji: "ğŸ«" },
                playa: { name: "Playa", emoji: "ğŸ–ï¸" },
                bosque: { name: "Bosque", emoji: "ğŸŒ²" },
                zoo: { name: "ZoolÃ³gico", emoji: "ğŸ¦" },
                granja: { name: "Granja", emoji: "ğŸ„" },
                casa: { name: "Casa", emoji: "ğŸ " },
                montaÃ±a: { name: "MontaÃ±a", emoji: "â›°ï¸" },
                espacio: { name: "Espacio Exterior", emoji: "ğŸš€" },
                circo: { name: "Circo", emoji: "ğŸª" },
                biblioteca: { name: "Biblioteca", emoji: "ğŸ“š" },
                acuario: { name: "Acuario", emoji: "ğŸ " },
                castillo: { name: "Castillo", emoji: "ğŸ°" },
                isla: { name: "Isla Tropical", emoji: "ğŸï¸" },
                submarino: { name: "Submarino", emoji: "ğŸ”" }
            };
            
            // Problemas para la historia
            const problems = {
                resfriado: { desc: "resfriado", emoji: "ğŸ¤§" },
                miedo: { desc: "miedo a la oscuridad", emoji: "ğŸŒ™" },
                herida: { desc: "herida en la rodilla", emoji: "ğŸ©¹" },
                tristeza: { desc: "tristeza", emoji: "ğŸ˜¢" },
                pesadilla: { desc: "pesadilla", emoji: "ğŸ˜±" },
                soledad: { desc: "soledad", emoji: "ğŸ§¸" },
                compartir: { desc: "no querer compartir", emoji: "ğŸ¤²" },
                dientes: { desc: "dolor de dientes", emoji: "ğŸ¦·" },
                berrinche: { desc: "berrinche", emoji: "ğŸ˜¤" },
                comida: { desc: "no querer comer verduras", emoji: "ğŸ¥¦" },
                perdido: { desc: "estar perdido", emoji: "ğŸ—ºï¸" },
                amistad: { desc: "hacer nuevos amigos", emoji: "ğŸ‘‹" },
                deporte: { desc: "miedo a intentar un nuevo deporte", emoji: "ğŸ€" },
                inyeccion: { desc: "miedo a las inyecciones", emoji: "ğŸ’‰" },
                examenes: { desc: "nervios por los exÃ¡menes", emoji: "ğŸ“" },
                timidez: { desc: "timidez", emoji: "ğŸ™ˆ" }
            };
            
            // Amigos para la historia
            const friends = {
                leon: { name: "LeÃ³n", emoji: "ğŸ¦" },
                jirafa: { name: "Jirafa", emoji: "ğŸ¦’" },
                elefante: { name: "Elefante", emoji: "ğŸ˜" },
                tigre: { name: "Tigre", emoji: "ğŸ¯" },
                conejo: { name: "Conejo", emoji: "ğŸ°" },
                tortuga: { name: "Tortuga", emoji: "ğŸ¢" },
                mariposa: { name: "Mariposa", emoji: "ğŸ¦‹" },
                delfin: { name: "DelfÃ­n", emoji: "ğŸ¬" },
                buho: { name: "BÃºho", emoji: "ğŸ¦‰" },
                perro: { name: "Perro", emoji: "ğŸ¶" },
                gato: { name: "Gato", emoji: "ğŸ±" },
                dragon: { name: "DragÃ³n", emoji: "ğŸ²" },
                koala: { name: "Koala", emoji: "ğŸ¨" },
                unicornio: { name: "Unicornio", emoji: "ğŸ¦„" },
                zorro: { name: "Zorro", emoji: "ğŸ¦Š" },
                pulpo: { name: "Pulpo", emoji: "ğŸ™" }
            };
            
            // Climas para la historia
            const weathers = {
                soleado: { desc: "soleado", emoji: "â˜€ï¸" },
                lluvia: { desc: "lluvioso", emoji: "ğŸŒ§ï¸" },
                nieve: { desc: "nevado", emoji: "â„ï¸" },
                tormenta: { desc: "con una tormenta elÃ©ctrica", emoji: "âš¡" },
                arcoiris: { desc: "con un hermoso arcoÃ­ris", emoji: "ğŸŒˆ" },
                niebla: { desc: "con niebla", emoji: "ğŸŒ«ï¸" },
                viento: { desc: "ventoso", emoji: "ğŸŒªï¸" },
                calor: { desc: "con mucho calor", emoji: "ğŸ”¥" },
                estrellado: { desc: "con un cielo estrellado", emoji: "âœ¨" },
                nublado: { desc: "nublado", emoji: "â˜ï¸" },
                granizo: { desc: "con granizo", emoji: "ğŸ§Š" },
                aurora: { desc: "con una aurora boreal", emoji: "ğŸŒŒ" }
            };
            
            // Objetos mÃ¡gicos para la historia
            const magicObjects = {
                varita: { name: "varita mÃ¡gica", emoji: "âœ¨" },
                pocion: { name: "pociÃ³n burbujeante", emoji: "ğŸ§ª" },
                mapa: { name: "mapa del tesoro", emoji: "ğŸ—ºï¸" },
                espejo: { name: "espejo encantado", emoji: "ğŸª" },
                lampara: { name: "lÃ¡mpara maravillosa", emoji: "ğŸª”" },
                libro: { name: "libro de hechizos", emoji: "ğŸ“•" },
                llave: { name: "llave dorada", emoji: "ğŸ”‘" },
                reloj: { name: "reloj que detiene el tiempo", emoji: "â°" },
                semilla: { name: "semilla que crece instantÃ¡neamente", emoji: "ğŸŒ±" },
                baston: { name: "bastÃ³n de nubes", emoji: "â˜ï¸" },
                alfombra: { name: "alfombra voladora", emoji: "ğŸ§" },
                caramelo: { name: "caramelo de superpoderes", emoji: "ğŸ¬" },
                guante: { name: "guante que transforma", emoji: "ğŸ§¤" },
                amuleto: { name: "amuleto de la suerte", emoji: "ğŸ”®" },
                sombrero: { name: "sombrero parlante", emoji: "ğŸ©" },
                anillo: { name: "anillo de invisibilidad", emoji: "ğŸ’" }
            };
            
            // Finales para la historia
            const endings = {
                fiesta: { desc: "con una fiesta de celebraciÃ³n", emoji: "ğŸ‰" },
                aprendizaje: { desc: "con una importante lecciÃ³n aprendida", emoji: "ğŸ“" },
                amistad: { desc: "con una nueva amistad", emoji: "ğŸ¤" },
                aventura: { desc: "preparÃ¡ndose para una nueva aventura", emoji: "ğŸ§­" },
                regalo: { desc: "recibiendo un regalo sorpresa", emoji: "ğŸ" },
                cancion: { desc: "cantando una canciÃ³n alegre", emoji: "ğŸµ" },
                abrazo: { desc: "con un abrazo grupal", emoji: "ğŸ«‚" },
                estrella: { desc: "pidiendo un deseo a una estrella", emoji: "â­" },
                arcoiris: { desc: "con un arcoÃ­ris mÃ¡gico", emoji: "ğŸŒˆ" },
                dormir: { desc: "yendo a dormir con dulces sueÃ±os", emoji: "ğŸ’¤" },
                desfile: { desc: "con un desfile de celebraciÃ³n", emoji: "ğŸª" },
                picnic: { desc: "disfrutando de un picnic mÃ¡gico", emoji: "ğŸ§º" },
                medalla: { desc: "recibiendo una medalla de valor", emoji: "ğŸ…" },
                viaje: { desc: "emprendiendo un viaje en globo", emoji: "ğŸˆ" }
            };
            
            // TÃ­tulos aleatorios para las historias
            const storyTitles = [
                "La Gran Aventura de CuraciÃ³n",
                "Un DÃ­a Especial con Panda y Mono",
                "La MisiÃ³n de Ayuda MÃ¡gica",
                "El Problema Especial",
                "El Rescate IncreÃ­ble",
                "Una LecciÃ³n para Recordar",
                "La Sorpresa del Doctor Mono",
                "El Plan Secreto de la Enfermera Panda",
                "Un Momento de ValentÃ­a",
                "El Misterio del DÃ­a ExtraÃ±o",
                "La SoluciÃ³n Inesperada",
                "Aventura en el [LUGAR]",
                "El DÃ­a que [PROBLEMA] DesapareciÃ³",
                "Un Amigo Especial Aparece",
                "La Magia del [OBJETO]",
                "El [CLIMA] DÃ­a de Amistad",
                "El Secreto del [LUGAR] Encantado",
                "Cuando [AMIGO] ConociÃ³ al Doctor Mono",
                "El Regalo de la Enfermera Panda",
                "La ExpediciÃ³n MÃ¡gica"
            ];
            
            // Plantillas para pÃ¡rrafos de las historias
            const storyTemplates = [
                // IntroducciÃ³n
                [
                    "Era un dÃ­a [CLIMA] en el [LUGAR]. La Enfermera Panda [PANDA_EMOJI] y el Doctor Mono [MONO_EMOJI] estaban [ACTIVIDAD_INICIAL] cuando de repente se encontraron con [AMIGO_EMOJI] el [AMIGO].",
                    "En el [LUGAR] [LUGAR_EMOJI], la Enfermera Panda [PANDA_EMOJI] organizaba sus vendas de colores mientras el Doctor Mono [MONO_EMOJI] practicaba sus mejores chistes. El dÃ­a estaba [CLIMA] y prometÃ­a ser especial.",
                    "[NOMBRE_NIÃ‘O]HabÃ­a una vez, en un [LUGAR] [LUGAR_EMOJI] muy especial, donde la Enfermera Panda [PANDA_EMOJI] y el Doctor Mono [MONO_EMOJI] ayudaban a todos los que lo necesitaban. Era un dÃ­a particularmente [CLIMA].",
                    "El [LUGAR] [LUGAR_EMOJI] brillaba especialmente [CLIMA] ese dÃ­a. La Enfermera Panda [PANDA_EMOJI] y el Doctor Mono [MONO_EMOJI] acababan de terminar de desayunar cuando escucharon un ruido extraÃ±o."
                ],
                
                // Desarrollo del problema
                [
                    "De pronto, se dieron cuenta de que habÃ­a un problema: [PROBLEMA_DESC] [PROBLEMA_EMOJI]. [AMIGO_EMOJI] El [AMIGO] estaba muy preocupado y no sabÃ­a quÃ© hacer.",
                    "Mientras conversaban, notaron que algo no estaba bien. El problema de [PROBLEMA_DESC] [PROBLEMA_EMOJI] estaba causando dificultades, y necesitaban encontrar una soluciÃ³n rÃ¡pidamente.",
                    "\"Â¡Oh no!\", exclamÃ³ la Enfermera Panda [PANDA_EMOJI]. \"Parece que tenemos un caso de [PROBLEMA_DESC] [PROBLEMA_EMOJI] y necesitamos actuar rÃ¡pido\". El Doctor Mono [MONO_EMOJI] asintiÃ³ seriamente (algo raro en Ã©l).",
                    "[NOMBRE_NIÃ‘O]De repente, todos se dieron cuenta del problema: [PROBLEMA_DESC] [PROBLEMA_EMOJI] estaba afectando a todos en el [LUGAR]. La Enfermera Panda [PANDA_EMOJI] sacÃ³ su libreta especial mientras el Doctor Mono [MONO_EMOJI] observaba con atenciÃ³n."
                ],
                
                // ApariciÃ³n del objeto mÃ¡gico
                [
                    "La Enfermera Panda [PANDA_EMOJI] recordÃ³ que tenÃ­a un objeto especial que podrÃ­a ayudar: Â¡un [OBJETO_MAGICO] [OBJETO_EMOJI]! \"Esto nos ayudarÃ¡\", dijo con una sonrisa.",
                    "\"Â¡Tengo una idea!\", exclamÃ³ el Doctor Mono [MONO_EMOJI] dando saltos de emociÃ³n. De su mochila sacÃ³ un [OBJETO_MAGICO] [OBJETO_EMOJI] que brillaba con luz propia.",
                    "[AMIGO_EMOJI] El [AMIGO] recordÃ³ que habÃ­a encontrado un [OBJETO_MAGICO] [OBJETO_EMOJI] durante su caminata matutina. \"Â¿Creen que esto pueda ayudarnos?\" preguntÃ³ tÃ­midamente.",
                    "Justo cuando la situaciÃ³n parecÃ­a complicarse, [NOMBRE_NIÃ‘O]la Enfermera Panda [PANDA_EMOJI] y el Doctor Mono [MONO_EMOJI] se miraron y exclamaron al unÃ­sono: \"Â¡El [OBJETO_MAGICO] [OBJETO_EMOJI]! Â¡Esa es la soluciÃ³n!\""
                ],
                
                // Plan y acciÃ³n
                [
                    "\"Tengo un plan\", dijo el Doctor Mono [MONO_EMOJI] con una sonrisa traviesa. \"Usaremos el [OBJETO_MAGICO] [OBJETO_EMOJI] para resolver el problema de [PROBLEMA_DESC] [PROBLEMA_EMOJI]\".",
                    "La Enfermera Panda [PANDA_EMOJI] reuniÃ³ a todos y explicÃ³ el plan: \"Con este [OBJETO_MAGICO] [OBJETO_EMOJI] y trabajando juntos, podremos solucionar este [PROBLEMA_DESC] [PROBLEMA_EMOJI]\".",
                    "[NOMBRE_NIÃ‘O]Todos se unieron bajo el liderazgo de la Enfermera Panda [PANDA_EMOJI] y el Doctor Mono [MONO_EMOJI]. Con el [OBJETO_MAGICO] [OBJETO_EMOJI] en mano, se dirigieron hacia el lugar donde el problema de [PROBLEMA_DESC] [PROBLEMA_EMOJI] era mÃ¡s fuerte.",
                    "\"1, 2, 3... Â¡Equipo de ayuda en acciÃ³n!\", gritaron todos juntos. Con el [AMIGO_EMOJI] [AMIGO] llevando el [OBJETO_MAGICO] [OBJETO_EMOJI], comenzaron su misiÃ³n para solucionar el [PROBLEMA_DESC] [PROBLEMA_EMOJI]."
                ],
                
                // ResoluciÃ³n
                [
                    "Usando sus conocimientos mÃ©dicos, la Enfermera Panda [PANDA_EMOJI] aplicÃ³ el poder del [OBJETO_MAGICO] [OBJETO_EMOJI] mientras el Doctor Mono [MONO_EMOJI] distraÃ­a a todos con sus graciosas muecas.",
                    "El [OBJETO_MAGICO] [OBJETO_EMOJI] comenzÃ³ a brillar intensamente. La Enfermera Panda [PANDA_EMOJI] sostuvo la mano de [AMIGO_EMOJI] el [AMIGO] mientras el Doctor Mono [MONO_EMOJI] recitaba palabras mÃ¡gicas de sanaciÃ³n.",
                    "Con un movimiento suave, el Doctor Mono [MONO_EMOJI] activÃ³ el [OBJETO_MAGICO] [OBJETO_EMOJI]. Una luz de colores envolviÃ³ el problema de [PROBLEMA_DESC] [PROBLEMA_EMOJI], transformÃ¡ndolo lentamente en algo mucho mejor.",
                    "[NOMBRE_NIÃ‘O]La Enfermera Panda [PANDA_EMOJI] sostuvo el [OBJETO_MAGICO] [OBJETO_EMOJI] en alto, y junto con el Doctor Mono [MONO_EMOJI] y [AMIGO_EMOJI] el [AMIGO], canalizaron toda su energÃ­a positiva para resolver el problema."
                ],
                
                // Final feliz
                [
                    "Y asÃ­, gracias al trabajo en equipo y al [OBJETO_MAGICO] [OBJETO_EMOJI], lograron resolver el problema de [PROBLEMA_DESC] [PROBLEMA_EMOJI]. Todos celebraron [FINAL_DESC] [FINAL_EMOJI].",
                    "El problema de [PROBLEMA_DESC] [PROBLEMA_EMOJI] desapareciÃ³ por completo. [AMIGO_EMOJI] El [AMIGO] no podÃ­a creerlo, y abrazÃ³ a la Enfermera Panda [PANDA_EMOJI] y al Doctor Mono [MONO_EMOJI]. La aventura terminÃ³ [FINAL_DESC] [FINAL_EMOJI].",
                    "\"Â¡Lo logramos!\", exclamÃ³ el Doctor Mono [MONO_EMOJI] dando volteretas de alegrÃ­a. La Enfermera Panda [PANDA_EMOJI] sonriÃ³ satisfecha mientras guardaba el [OBJETO_MAGICO] [OBJETO_EMOJI] para la prÃ³xima aventura. Todos terminaron el dÃ­a [FINAL_DESC] [FINAL_EMOJI].",
                    "[NOMBRE_NIÃ‘O]El sol comenzÃ³ a ponerse en el [LUGAR] [LUGAR_EMOJI], pero los corazones de todos estaban llenos de alegrÃ­a. El problema de [PROBLEMA_DESC] [PROBLEMA_EMOJI] ya era cosa del pasado, y la Enfermera Panda [PANDA_EMOJI] y el Doctor Mono [MONO_EMOJI] se despidieron [FINAL_DESC] [FINAL_EMOJI]."
                ]
            ];
            
            // Actividades iniciales aleatorias
            const initialActivities = [
                "revisando sus instrumentos mÃ©dicos",
                "desayunando plÃ¡tanos y bambÃº",
                "preparando medicinas especiales",
                "jugando al escondite",
                "leyendo libros de medicina divertida",
                "decorando vendas de colores",
                "practicando bailes curativos",
                "ordenando pociones curativas",
                "inventando chistes medicinales",
                "plantando flores curativas",
                "dando la bienvenida a los visitantes",
                "haciendo ejercicios matutinos"
            ];
            
            // FunciÃ³n para generar una historia aleatoria
            function generateRandomStory() {
                // Seleccionar opciones aleatorias
                const placeSelect = document.getElementById('place');
                const problemSelect = document.getElementById('problem');
                const friendSelect = document.getElementById('friend');
                const weatherSelect = document.getElementById('weather');
                const magicObjectSelect = document.getElementById('magicObject');
                const endingSelect = document.getElementById('ending');
                
                // Establecer valores aleatorios
                placeSelect.value = getRandomKey(places);
                problemSelect.value = getRandomKey(problems);
                friendSelect.value = getRandomKey(friends);
                weatherSelect.value = getRandomKey(weathers);
                magicObjectSelect.value = getRandomKey(magicObjects);
                endingSelect.value = getRandomKey(endings);
                
                // Generar la historia
                generateStory();
            }
            
            // FunciÃ³n para obtener una clave aleatoria de un objeto
            function getRandomKey(obj) {
                const keys = Object.keys(obj);
                return keys[Math.floor(Math.random() * keys.length)];
            }
            
            // FunciÃ³n para generar la historia
            function generateStory() {
                // Mostrar indicador de carga
                formContainer.style.display = 'none';
                loadingIndicator.style.display = 'block';
                storyContainer.style.display = 'none';
                
                // Obtener valores seleccionados
                const childName = document.getElementById('childName').value.trim();
                const placeKey = document.getElementById('place').value;
                const problemKey = document.getElementById('problem').value;
                const friendKey = document.getElementById('friend').value;
                const weatherKey = document.getElementById('weather').value;
                const magicObjectKey = document.getElementById('magicObject').value;
                const endingKey = document.getElementById('ending').value;
                
                // Obtener detalles basados en las selecciones
                const place = places[placeKey];
                const problem = problems[problemKey];
                const friend = friends[friendKey];
                const weather = weathers[weatherKey];
                const magicObject = magicObjects[magicObjectKey];
                const ending = endings[endingKey];
                
                // Crear la historia
                setTimeout(() => {
                    // Generar tÃ­tulo aleatorio
                    let title = storyTitles[Math.floor(Math.random() * storyTitles.length)];
                    title = title.replace('[LUGAR]', place.name);
                    title = title.replace('[PROBLEMA]', problem.desc);
                    title = title.replace('[OBJETO]', magicObject.name);
                    title = title.replace('[CLIMA]', weather.desc);
                    title = title.replace('[AMIGO]', friend.name);
                    
                    // Establecer el tÃ­tulo
                    storyTitle.textContent = title;
                    
                    // Limpiar el contenido anterior
                    storyContent.innerHTML = '';
                    
                    // AÃ±adir nombre del niÃ±o si se proporcionÃ³
                    const nombreNinoText = childName ? `${childName} estaba allÃ­ cuando ` : '';
                    
                    // Seleccionar plantillas aleatorias para cada secciÃ³n
                    const intro = storyTemplates[0][Math.floor(Math.random() * storyTemplates[0].length)];
                    const problemDev = storyTemplates[1][Math.floor(Math.random() * storyTemplates[1].length)];
                    const magicObjectAppears = storyTemplates[2][Math.floor(Math.random() * storyTemplates[2].length)];
                    const plan = storyTemplates[3][Math.floor(Math.random() * storyTemplates[3].length)];
                    const resolution = storyTemplates[4][Math.floor(Math.random() * storyTemplates[4].length)];
                    const happyEnding = storyTemplates[5][Math.floor(Math.random() * storyTemplates[5].length)];
                    
                    // Actividad inicial aleatoria
                    const randomActivity = initialActivities[Math.floor(Math.random() * initialActivities.length)];
                    
                    // Reemplazar placeholders con valores reales
                    let story = [intro, problemDev, magicObjectAppears, plan, resolution, happyEnding].map(template => {
                        let paragraph = template;
                        paragraph = paragraph.replace('[LUGAR]', place.name);
                        paragraph = paragraph.replace('[LUGAR_EMOJI]', place.emoji);
                        paragraph = paragraph.replace('[CLIMA]', weather.desc);
                        paragraph = paragraph.replace('[PROBLEMA_DESC]', problem.desc);
                        paragraph = paragraph.replace('[PROBLEMA_EMOJI]', problem.emoji);
                        paragraph = paragraph.replace('[AMIGO]', friend.name);
                        paragraph = paragraph.replace('[AMIGO_EMOJI]', friend.emoji);
                        paragraph = paragraph.replace('[OBJETO_MAGICO]', magicObject.name);
                        paragraph = paragraph.replace('[OBJETO_EMOJI]', magicObject.emoji);
                        paragraph = paragraph.replace('[ACTIVIDAD_INICIAL]', randomActivity);
                        paragraph = paragraph.replace('[FINAL_DESC]', ending.desc);
                        paragraph = paragraph.replace('[FINAL_EMOJI]', ending.emoji);
                        paragraph = paragraph.replace('[MONO_EMOJI]', 'ğŸ’');
                        paragraph = paragraph.replace('[PANDA_EMOJI]', 'ğŸ¼');
                        paragraph = paragraph.replace('[NOMBRE_NIÃ‘O]', nombreNinoText);
                        return paragraph;
                    });
                    
                    // AÃ±adir pÃ¡rrafos a la historia con animaciÃ³n de apariciÃ³n
                    story.forEach((paragraph, index) => {
                        const p = document.createElement('p');
                        p.className = 'story-paragraph';
                        p.style.animationDelay = `${index * 0.5}s`;
                        p.innerHTML = paragraph;
                        storyContent.appendChild(p);
                    });
                    
                    // Ocultar indicador de carga y mostrar la historia
                    loadingIndicator.style.display = 'none';
                    storyContainer.style.display = 'block';
                    
                    // Ejecutar Twemoji en el contenido de la historia
                    twemoji.parse(storyContent, {
                        folder: 'svg',
                        ext: '.svg'
                    });
                    
                    // Hacer que los personajes flotantes reboten para celebrar
                    const floaters = document.querySelectorAll('.character-floater');
                    floaters.forEach(floater => {
                        floater.classList.add('character-bounce');
                        setTimeout(() => {
                            floater.classList.remove('character-bounce');
                        }, 3000);
                    });
                    
                    // Scroll a la historia
                    storyContainer.scrollIntoView({ behavior: 'smooth' });
                }, 2000); // Simular tiempo de carga
            }
            
            // Event Listeners
            generateBtn.addEventListener('click', generateStory);
            randomBtn.addEventListener('click', generateRandomStory);
            newStoryBtn.addEventListener('click', function() {
                storyContainer.style.display = 'none';
                formContainer.style.display = 'block';
                window.scrollTo({ top: formContainer.offsetTop - 50, behavior: 'smooth' });
            });
            
            // Hacer que las imÃ¡genes de los personajes flotantes sean interactivas
            const characterFloaters = document.querySelectorAll('.character-floater');
            characterFloaters.forEach(floater => {
                floater.addEventListener('click', function() {
                    this.classList.toggle('character-bounce');
                    setTimeout(() => {
                        this.classList.remove('character-bounce');
                    }, 2000);
                });
            });
        });
    </script>
</body>
</html>
